import errno
import os
import select
import signal

import signalfd

fd = signalfd.init()

while 1:
	try:
		r, w, x = select.select([fd], [], [])
	except select.error as e:
		if e.args[0] == errno.EINTR:
			continue
		raise

	if r:
		buf = os.read(fd, 1)
		if not buf:
			break

		if isinstance(buf, str):
			sig = ord(buf[0])  # Python 2
		else:
			sig, = buf         # Python 3

		if sig == signal.SIGTERM:
			break
